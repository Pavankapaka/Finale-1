<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jai Kisan - Your Farming Ally</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 700px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 40vh;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 400px;
            }
        }
    </style>
</head>
<body class="bg-[#FAF8F5] text-[#332D2D]">

    <header class="bg-[#F5F0E1] shadow-sm sticky top-0 z-10">
        <div class="container mx-auto px-4 py-3 flex justify-between items-center">
            <div class="flex items-center space-x-3">
                <span class="text-3xl text-[#E5734A]">ðŸŒ±</span>
                <h1 class="text-xl font-bold text-[#E5734A]">Jai Kisan</h1>
            </div>
            <button id="voice-assistant-btn" class="p-2 rounded-full hover:bg-stone-200 focus:outline-none focus:ring-2 focus:ring-[#E5734A] focus:ring-offset-2">
                <span class="text-2xl text-[#E5734A]">ðŸŽ¤</span>
            </button>
        </div>
    </header>

    <main class="container mx-auto p-4 md:p-8">
        
        <section id="hero" class="text-center mb-10 py-12">
            <h2 class="text-3xl md:text-4xl font-bold mb-3">Your Expert Farming Ally</h2>
            <p class="text-lg md:text-xl text-gray-600 max-w-3xl mx-auto">Get instant, actionable advice to protect your crops, maximize income, and navigate complex agricultural schemes.</p>
        </section>

        <section id="feature-cards" class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-12">
            <a href="#diagnose-section" class="flex flex-col items-center p-8 bg-[#F5F0E1] rounded-2xl shadow-md hover:shadow-lg transition-shadow duration-300">
                <span class="text-5xl text-[#E5734A] mb-3">ðŸ“¸</span>
                <h3 class="text-xl font-semibold text-center">Diagnose Crop Diseases</h3>
                <p class="text-sm text-gray-500 text-center mt-2">Upload a photo for instant diagnosis and remedies.</p>
            </a>
            <a href="#market-section" class="flex flex-col items-center p-8 bg-[#F5F0E1] rounded-2xl shadow-md hover:shadow-lg transition-shadow duration-300">
                <span class="text-5xl text-[#E5734A] mb-3">ðŸ“Š</span>
                <h3 class="text-xl font-semibold text-center">Market Price Analysis</h3>
                <p class="text-sm text-gray-500 text-center mt-2">Get live trends and AI-powered forecasts.</p>
            </a>
            <a href="#schemes-section" class="flex flex-col items-center p-8 bg-[#F5F0E1] rounded-2xl shadow-md hover:shadow-lg transition-shadow duration-300">
                <span class="text-5xl text-[#E5734A] mb-3">ðŸ’¡</span>
                <h3 class="text-xl font-semibold text-center">Govt. Scheme Navigator</h3>
                <p class="text-sm text-gray-500 text-center mt-2">Find relevant subsidies and grants in simple terms.</p>
            </a>
        </section>
        
        <section id="diagnose-section" class="bg-white p-6 md:p-8 rounded-xl shadow-lg max-w-4xl mx-auto my-12">
            <h3 class="text-2xl font-bold mb-4 text-center text-[#E5734A]">Instant Crop Health Scanner</h3>
            <p class="text-center text-gray-600 mb-6">Upload a photo of an affected plant leaf. Our AI will identify the issue and suggest effective, locally available remedies.</p>
            <div class="flex flex-col items-center">
                <div id="image-preview-container" class="w-full max-w-md h-64 border-2 border-dashed border-gray-300 rounded-lg flex items-center justify-center bg-gray-50 mb-4">
                     <p id="image-placeholder-text" class="text-gray-500">Your image will appear here</p>
                     <img id="image-preview" src="" alt="Image Preview" class="hidden h-full w-full object-contain rounded-lg"/>
                </div>
                <input type="file" id="crop-image-upload" class="hidden" accept="image/*">
                <button id="upload-button" class="w-full max-w-md bg-[#E5734A] text-white font-semibold py-3 px-6 rounded-lg hover:bg-orange-600 transition-colors duration-300 focus:outline-none focus:ring-2 focus:ring-[#E5734A] focus:ring-offset-2">
                    Select Photo to Diagnose
                </button>
            </div>
            <div id="diagnosis-result" class="mt-6 hidden">
                <div id="loader" class="text-center">
                    <p class="text-lg font-medium text-gray-700 animate-pulse">Analyzing your crop... ðŸ§ </p>
                </div>
                <div id="result-content" class="hidden">
                    <h4 class="text-xl font-bold mb-2">Diagnosis Result:</h4>
                    <div class="bg-stone-100 p-4 rounded-md border border-stone-200">
                        <p id="disease-name" class="font-semibold text-red-600"></p>
                        <p id="remedy-advice" class="text-gray-700 mt-2"></p>
                    </div>
                </div>
            </div>
        </section>
        
        <section id="market-section" class="bg-white p-6 md:p-8 rounded-xl shadow-lg max-w-4xl mx-auto my-12">
             <h3 class="text-2xl font-bold mb-4 text-center text-[#E5734A]">Real-Time Market Analysis</h3>
             <p class="text-center text-gray-600 mb-6">Get live market prices and AI-powered trend analysis to decide the best time to sell your produce.</p>
             <div class="flex justify-center items-center space-x-4 mb-6">
                 <label for="crop-select" class="font-medium">Select Crop:</label>
                 <select id="crop-select" class="p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#E5734A]">
                     <option value="wheat" selected>Wheat</option>
                     <option value="corn">Corn</option>
                     <option value="rice">Rice</option>
                     <option value="soybeans">Soybeans</option>
                     <option value="tomato">Tomato</option>
                     <option value="onion">Onion</option>
                     <option value="potato">Potato</option>
                 </select>
             </div>
             <div class="grid grid-cols-1 md:grid-cols-2 gap-6 items-center">
                 <div>
                     <div class="chart-container">
                         <canvas id="market-chart"></canvas>
                     </div>
                 </div>
                 <div class="flex flex-col justify-center">
                     <h4 class="text-xl font-bold mb-2 text-gray-800">AI Analyst Summary:</h4>
                     <div id="market-summary" class="bg-stone-100 p-4 rounded-md border border-stone-200">
                         <p class="text-gray-700">Select a crop to see the latest price trends and analysis.</p>
                     </div>
                 </div>
             </div>
        </section>

        <section id="schemes-section" class="bg-white p-6 md:p-8 rounded-xl shadow-lg max-w-4xl mx-auto my-12">
            <h3 class="text-2xl font-bold mb-4 text-center text-[#E5734A]">Government Scheme Navigator</h3>
            <p class="text-center text-gray-600 mb-6">Ask about your needs, like "drip irrigation subsidy," to find relevant government schemes explained in simple terms.</p>
            <div class="flex space-x-2">
                <input id="scheme-search-input" type="text" placeholder="e.g., subsidies for drip irrigation" class="flex-grow p-3 border border-gray-300 rounded-l-lg focus:outline-none focus:ring-2 focus:ring-[#E5734A]">
                <button id="scheme-search-button" class="bg-[#E5734A] text-white font-semibold py-3 px-5 rounded-r-lg hover:bg-orange-600 transition-colors">Search</button>
            </div>
            <div id="schemes-result" class="mt-6 space-y-3">
               <p class="text-center text-gray-500">Search results will appear here.</p>
            </div>
        </section>

        <div id="voice-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
            <div class="bg-white p-8 rounded-lg shadow-xl text-center">
                <span class="text-5xl mb-4 inline-block text-[#E5734A]">ðŸŽ¤</span>
                <p class="text-xl font-medium">Voice assistant is active.</p>
                <p class="text-gray-600">Please state your query clearly.</p>
                <button id="close-voice-modal" class="mt-6 bg-stone-300 text-gray-800 px-4 py-2 rounded-lg hover:bg-stone-400">Close</button>
            </div>
        </div>

    </main>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const marketData = {
                wheat: {
                    labels: ['Day 1', 'Day 2', 'Day 3', 'Day 4', 'Day 5', 'Day 6', 'Day 7'],
                    prices: [2500, 2480, 2450, 2420, 2400, 2380, 2350],
                    summary: "Global wheat prices have been declining due to ample supplies and subdued import demand from Asia and North Africa. Larger harvests in the European Union and Russia are contributing to this downward trend. Consider holding for a potential rebound or selling to mitigate further price erosion."
                },
                corn: {
                    labels: ['Day 1', 'Day 2', 'Day 3', 'Day 4', 'Day 5', 'Day 6', 'Day 7'],
                    prices: [2300, 2350, 2400, 2420, 2450, 2480, 2510],
                    summary: "Maize (corn) prices have risen for the third consecutive month, driven by concerns over heatwaves affecting yields in the European Union. Strong demand for feed and ethanol production, especially in the United States, is also supporting the price increase. The forecast is positive; selling now could capitalize on high prices."
                },
                rice: {
                    labels: ['Day 1', 'Day 2', 'Day 3', 'Day 4', 'Day 5', 'Day 6', 'Day 7'],
                    prices: [2800, 2750, 2700, 2680, 2650, 2600, 2550],
                    summary: "Rice prices have experienced a decline due to continued competition among exporters and reduced global demand. The market is currently facing a downward trend. It is advisable to monitor the situation closely for any signs of a turnaround."
                },
                soybeans: {
                    labels: ['Day 1', 'Day 2', 'Day 3', 'Day 4', 'Day 5', 'Day 6', 'Day 7'],
                    prices: [4200, 4150, 4100, 4120, 4150, 4180, 4220],
                    summary: "Soybean prices have been relatively stable with minor fluctuations. Prospects of ample global supplies in the upcoming season are preventing a significant price increase. The market is favorable, and selling at a premium or in bulk can secure good returns."
                },
                tomato: {
                    labels: ['Day 1', 'Day 2', 'Day 3', 'Day 4', 'Day 5', 'Day 6', 'Day 7'],
                    prices: [1200, 1250, 1300, 1280, 1400, 1550, 1500],
                    summary: "Tomato prices are showing a strong upward trend this week. Holding for another day or two could result in better profits. The forecast is positive."
                },
                onion: {
                    labels: ['Day 1', 'Day 2', 'Day 3', 'Day 4', 'Day 5', 'Day 6', 'Day 7'],
                    prices: [2100, 2050, 2000, 2150, 2200, 2180, 2250],
                    summary: "Onion prices have been volatile but are currently rising. Selling now would be a safe bet to capitalize on the current high."
                },
                potato: {
                    labels: ['Day 1', 'Day 2', 'Day 3', 'Day 4', 'Day 5', 'Day 6', 'Day 7'],
                    prices: [950, 980, 960, 970, 1000, 1020, 1010],
                    summary: "Potato prices are stable with a slight upward movement. There is no urgency to sell, but the market is favorable."
                }
            };

            const schemesData = [
                {
                    id: 1,
                    keywords: ['drip', 'irrigation', 'water', 'micro'],
                    title: 'Pradhan Mantri Krishi Sinchayee Yojana (PMKSY)',
                    description: 'Provides financial assistance to farmers for adopting micro-irrigation systems like drips and sprinklers to promote water conservation.',
                    eligibility: 'All categories of farmers are eligible.',
                    link: '#'
                },
                {
                    id: 2,
                    keywords: ['soil', 'health', 'testing'],
                    title: 'Soil Health Card Scheme',
                    description: 'Aims to issue soil health cards to farmers which will carry crop-wise recommendations of nutrients and fertilizers required for the individual farms to help farmers improve productivity.',
                    eligibility: 'All farmers can avail this service.',
                    link: '#'
                },
                {
                    id: 3,
                    keywords: ['insurance', 'crop', 'loss'],
                    title: 'Pradhan Mantri Fasal Bima Yojana (PMFBY)',
                    description: 'Provides a comprehensive insurance cover against failure of the crop thus helping in stabilising the income of the farmers.',
                    eligibility: 'All farmers including sharecroppers and tenant farmers growing notified crops in the notified areas are eligible for coverage.',
                    link: '#'
                }
            ];

            document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function (e) {
                    e.preventDefault();
                    document.querySelector(this.getAttribute('href')).scrollIntoView({
                        behavior: 'smooth'
                    });
                });
            });

            const uploadButton = document.getElementById('upload-button');
            const fileInput = document.getElementById('crop-image-upload');
            const imagePreview = document.getElementById('image-preview');
            const imagePlaceholderText = document.getElementById('image-placeholder-text');
            const diagnosisResult = document.getElementById('diagnosis-result');
            const loader = document.getElementById('loader');
            const resultContent = document.getElementById('result-content');
            const diseaseName = document.getElementById('disease-name');
            const remedyAdvice = document.getElementById('remedy-advice');
            
            uploadButton.addEventListener('click', () => fileInput.click());

            fileInput.addEventListener('change', (event) => {
                const file = event.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        imagePreview.src = e.target.result;
                        imagePreview.classList.remove('hidden');
                        imagePlaceholderText.classList.add('hidden');
                        diagnosisResult.classList.remove('hidden');
                        loader.classList.remove('hidden');
                        resultContent.classList.add('hidden');

                        setTimeout(() => {
                            loader.classList.add('hidden');
                            diseaseName.textContent = 'Identified: Tomato Yellow Leaf Curl Virus';
                            remedyAdvice.innerHTML = '<strong>Actionable Advice:</strong><br>1. Remove and destroy infected plants immediately to prevent spread.<br>2. Use yellow sticky traps to control whiteflies, the primary carriers.<br>3. Apply a Neem oil-based pesticide (locally available and affordable) every 7 days.';
                            resultContent.classList.remove('hidden');
                        }, 2500);
                    }
                    reader.readAsDataURL(file);
                }
            });

            let marketChart;
            const ctx = document.getElementById('market-chart').getContext('2d');
            const cropSelect = document.getElementById('crop-select');
            const marketSummary = document.getElementById('market-summary');

            function createOrUpdateChart(crop) {
                const data = marketData[crop];
                marketSummary.innerHTML = `<p class="text-gray-700">${data.summary}</p>`;
                
                if (marketChart) {
                    marketChart.data.labels = data.labels;
                    marketChart.data.datasets[0].data = data.prices;
                    marketChart.update();
                } else {
                    marketChart = new Chart(ctx, {
                        type: 'line',
                        data: {
                            labels: data.labels,
                            datasets: [{
                                label: 'Price per Quintal (â‚¹)',
                                data: data.prices,
                                borderColor: '#E5734A',
                                backgroundColor: 'rgba(229, 115, 74, 0.1)',
                                borderWidth: 2,
                                tension: 0.4,
                                fill: true,
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            scales: {
                                y: {
                                    beginAtZero: false,
                                    ticks: {
                                        callback: function(value) {
                                            return 'â‚¹' + value;
                                        }
                                    }
                                }
                            },
                            plugins: {
                                legend: {
                                    display: false
                                },
                                tooltip: {
                                    callbacks: {
                                        label: function(context) {
                                            return `Price: â‚¹${context.parsed.y}`;
                                        }
                                    }
                                }
                            }
                        }
                    });
                }
            }
            
            cropSelect.addEventListener('change', (event) => {
                createOrUpdateChart(event.target.value);
            });
            
            createOrUpdateChart('wheat');

            const schemeSearchInput = document.getElementById('scheme-search-input');
            const schemeSearchButton = document.getElementById('scheme-search-button');
            const schemesResult = document.getElementById('schemes-result');

            schemeSearchButton.addEventListener('click', performSchemeSearch);
            schemeSearchInput.addEventListener('keyup', (e) => {
                if (e.key === 'Enter') {
                    performSchemeSearch();
                }
            });

            function performSchemeSearch() {
                const query = schemeSearchInput.value.toLowerCase();
                schemesResult.innerHTML = '';
                if (!query) {
                    schemesResult.innerHTML = '<p class="text-center text-gray-500">Please enter a search term.</p>';
                    return;
                }
                const results = schemesData.filter(scheme => 
                    scheme.keywords.some(keyword => query.includes(keyword)) ||
                    scheme.title.toLowerCase().includes(query)
                );
                
                if (results.length > 0) {
                    results.forEach(scheme => {
                        const schemeElement = document.createElement('div');
                        schemeElement.className = 'border border-gray-200 rounded-lg';
                        schemeElement.innerHTML = `
                            <button class="w-full text-left p-4 font-semibold hover:bg-gray-50 flex justify-between items-center accordion-header">
                                ${scheme.title}
                                <span class="transform transition-transform duration-300">â–¼</span>
                            </button>
                            <div class="p-4 border-t border-gray-200 hidden accordion-content bg-gray-50">
                                <p class="mb-2">${scheme.description}</p>
                                <p class="mb-2"><strong>Eligibility:</strong> ${scheme.eligibility}</p>
                                <a href="${scheme.link}" target="_blank" class="text-[#E5734A] font-semibold hover:underline">Apply Here &rarr;</a>
                            </div>
                        `;
                        schemesResult.appendChild(schemeElement);
                    });
                    addAccordionListeners();
                } else {
                    schemesResult.innerHTML = '<p class="text-center text-gray-500">No schemes found matching your query.</p>';
                }
            }

            function addAccordionListeners() {
                document.querySelectorAll('.accordion-header').forEach(button => {
                    button.addEventListener('click', () => {
                        const content = button.nextElementSibling;
                        const arrow = button.querySelector('span');
                        content.classList.toggle('hidden');
                        arrow.classList.toggle('rotate-180');
                    });
                });
            }

            const voiceModal = document.getElementById('voice-modal');
            document.getElementById('voice-assistant-btn').addEventListener('click', () => {
                voiceModal.classList.remove('hidden');
                voiceModal.classList.add('flex');
            });
            document.getElementById('close-voice-modal').addEventListener('click', () => {
                voiceModal.classList.add('hidden');
                voiceModal.classList.remove('flex');
            });
        });
    </script>
</body>
</html>
